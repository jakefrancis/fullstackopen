(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(19),s=n.n(r),o=n(10),i=n(2),l=n.n(i),u=n(4),b=n(3),j=n(0),d=function(e){var t=e.iconName,n=e.component,c=e.componentTrail,a=void 0===c?"":c;return Object(j.jsx)("svg",{className:"".concat(n,"__icon").concat(a),fill:"black",width:"16px",height:"16px",viewBox:"0 0 20 20",children:Object(j.jsx)("use",{xlinkHref:"/sprite.svg#icon-".concat(t)})})},p=function(e){var t=e.blog,n=e.updateLike,a=e.user,r=e.deleteBlog,s=Object(c.useState)(!0),o=Object(b.a)(s,2),i=o[0],l=o[1],u=Object(c.useState)(!1),p=Object(b.a)(u,2),f=p[0],m=p[1],h=function(){l(!i),i&&g()},g=function(){var e=t.likedBy.map((function(e){return e.username}));m(e.includes(a))};return Object(c.useEffect)((function(){l(!0)}),[]),Object(j.jsxs)("div",{className:"blog",children:[Object(j.jsxs)("div",{className:"blog__description",children:[Object(j.jsxs)("span",{className:"blog__description--title",children:[t.title," "]}),Object(j.jsxs)("span",{className:"blog__description--author",children:["- ",t.author]})]}),i?Object(j.jsxs)("div",{className:"blog__button",children:[Object(j.jsx)("button",{className:"btn-inline",onClick:h,children:"view"}),Object(j.jsx)("p",{className:"blog__button--likes",children:f?"rooted: ".concat(t.likes):"roots: ".concat(t.likes)})]}):Object(j.jsxs)("div",{className:"blog__details",children:[Object(j.jsxs)("div",{className:"blog__button",children:[Object(j.jsx)("button",{className:"btn-inline",onClick:h,children:"hide"}),Object(j.jsx)("p",{className:"blog__button--likes",children:f?"rooted: ".concat(t.likes):"roots: ".concat(t.likes)})]}),Object(j.jsx)("div",{className:"blog__info",children:Object(j.jsx)("a",{className:"blog__link",href:"http"!==t.url.slice(0,4)?"//"+t.url:t.url,children:t.url})}),Object(j.jsx)("div",{className:"blog__like-container",children:Object(j.jsx)("button",{className:"blog__like-container--like-button",onClick:function(e){e.preventDefault(),n(t),m(!f)},children:f?Object(j.jsx)(d,{component:"blog",componentTrail:"--unlike",iconName:"thumbs-up"}):Object(j.jsx)(d,{component:"blog",componentTrail:"--like",iconName:"thumbs-up"})})}),Object(j.jsxs)("div",{className:"blog__posted",children:[Object(j.jsxs)("h3",{children:["Posted By: ",t.user.name]}),a===t.user.username?Object(j.jsx)("button",{className:"btn-inline blog__posted--remove",onClick:function(e){e.preventDefault();var n="Are you sure you want to remove ".concat(t.title," by ").concat(t.author,"?");window.confirm(n)&&r(t)},children:"remove"}):null]})]})]})},f=function(e){var t=e.login,n=Object(c.useState)(""),a=Object(b.a)(n,2),r=a[0],s=a[1],o=Object(c.useState)(""),i=Object(b.a)(o,2),p=i[0],f=i[1],m=function(){var e=Object(u.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({username:r,password:p}),s(""),f("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("form",{className:"login",onSubmit:m,id:"loginForm",children:[Object(j.jsx)(d,{component:"login",iconName:"lock-closed-outline"}),Object(j.jsxs)("div",{className:"login__input",children:[Object(j.jsx)("label",{className:"login__label",children:"Username"}),Object(j.jsx)("input",{id:"username",type:"text",value:r,name:"Username",onChange:function(e){s(e.target.value)},label:"Username:"})]}),Object(j.jsxs)("div",{className:"login__input",children:[Object(j.jsx)("label",{className:"login__label",children:"Password"}),Object(j.jsx)("input",{id:"password",type:"password",value:p,name:"Password",onChange:function(e){f(e.target.value)}})]}),Object(j.jsx)("button",{className:"btn-inline",type:"submit",children:"login"})]})},m=function(e){var t=e.createBlog,n=Object(c.useState)(""),a=Object(b.a)(n,2),r=a[0],s=a[1],o=Object(c.useState)(""),i=Object(b.a)(o,2),l=i[0],u=i[1],d=Object(c.useState)(""),p=Object(b.a)(d,2),f=p[0],m=p[1];return Object(j.jsxs)("form",{className:"blog-form",onSubmit:function(e){e.preventDefault(),t({author:r,title:l,url:f}),u(""),m(""),s("")},children:[Object(j.jsx)("h2",{children:"Create New"}),Object(j.jsxs)("div",{className:"blog-form__input",children:[Object(j.jsx)("label",{children:"Title"}),Object(j.jsx)("input",{id:"title",type:"text",name:"Title",value:l,onChange:function(e){u(e.target.value)}})]}),Object(j.jsxs)("div",{className:"blog-form__input",children:[Object(j.jsx)("label",{children:"Author"}),Object(j.jsx)("input",{id:"author",type:"text",value:r,name:"Author",onChange:function(e){s(e.target.value)}})]}),Object(j.jsxs)("div",{className:"blog-form__input",children:[Object(j.jsx)("label",{children:"Url"}),Object(j.jsx)("input",{id:"url",type:"text",value:f,name:"Url",onChange:function(e){m(e.target.value)}})]}),Object(j.jsx)("button",{className:"btn-inline blog-form__button",type:"submit",children:"save"})]})},h=a.a.forwardRef((function(e,t){var n=Object(c.useState)(!1),a=Object(b.a)(n,2),r=a[0],s=a[1],o={display:r?"none":""},i={display:r?"":"none"},l=function(){s(!r)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(j.jsxs)("div",{className:"toggle",children:[Object(j.jsx)("div",{style:o,children:Object(j.jsx)("button",{className:"btn-inline show__blogform__btn",onClick:l,children:e.buttonLabel})}),Object(j.jsxs)("div",{className:"toggle",style:i,children:[Object(j.jsx)("button",{className:"btn-inline show__blogform__btn",onClick:l,children:"cancel"}),e.children]})]})}));h.displayName="Togglable";var g=h,O=n(6),v=n.n(O),x="/api/blogs",_=null,N={getAll:function(){return v.a.get(x).then((function(e){return e.data}))},createBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:_}},e.next=3,v.a.post(x,t,n);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),likeBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:_}},c="".concat(x,"/").concat(t.id),e.next=4,v.a.put(c,t.likes,n);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:_}},c="".concat(x,"/").concat(t.id),e.next=4,v.a.delete(c,n);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){_="bearer ".concat(e)}},k={login:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(e){var t=e.message;return null===t?null:Object(j.jsx)("div",{className:"notification",id:"notification",children:Object(j.jsx)("h2",{className:t.type,children:t.content})})},y=function(e){var t=e.message,n=e.user,c=e.handleLogout;return Object(j.jsxs)("div",{className:"header",children:[t?Object(j.jsx)("div",{className:"header__title",children:Object(j.jsx)(w,{message:t})}):Object(j.jsx)("div",{className:"header__title",children:Object(j.jsx)("img",{className:"header__title--logo",src:"img/logo-name.png",alt:"blog cabin logo"})}),n?Object(j.jsxs)("div",{className:"logout",children:[Object(j.jsxs)("p",{className:"logout__user",children:["Hello, ",n.name]}),Object(j.jsx)("button",{className:"btn-inline",onClick:c,children:"logout"})]}):null]})},B=function(){var e=Object(c.useState)([]),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),s=Object(b.a)(r,2),i=s[0],d=s[1],h=Object(c.useState)(null),O=Object(b.a)(h,2),v=O[0],x=O[1],_=Object(c.useRef)(),w=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.getAll();case 2:t=e.sent,a(t.sort((function(e,t){return t.likes-e.likes})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)(w,[]),Object(c.useEffect)((function(){var e=window.localStorage.getItem("loggedInBlogappUser");if(e){var t=JSON.parse(e);x(t),N.setToken(t.token)}}),[]);var B=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedInBlogappUser",JSON.stringify(n)),N.setToken(n.token),x(n),d({type:"notification__message",content:"".concat(n.username," login successfull")}),setTimeout((function(){d(null)}),5e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),d({type:"notification__error",content:"wrong credentials"}),setTimeout((function(){d(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(l.a.mark((function e(t){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.createBlog(t);case 3:c=e.sent,_.current.toggleVisibility(),a(n.concat(c)),d({type:"notification__message",content:"a new blog ".concat(c.title).concat(""===c.author?"":" by ".concat(c.author))}),setTimeout((function(){d(null)}),5e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),d({type:"notification__error",content:"Title and Url fields are required"}),setTimeout((function(){d(null)}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(l.a.mark((function e(t){var c,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.likeBlog(t);case 3:c=e.sent,r=Object(o.a)(n),s=r.findIndex((function(e){return e.id===c.id})),r[s]=c,a(r),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),d({type:"notification__error",content:"like error"}),setTimeout((function(){d(null)}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(u.a)(l.a.mark((function e(t){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.deleteBlog(t);case 3:c=(c=Object(o.a)(n)).filter((function(e){return e.id!==t.id})),a(c),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),d({type:"notification__error",content:"unauthorized"}),setTimeout((function(){d(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)(y,{message:i,user:v,handleLogout:function(e){e.preventDefault(),window.localStorage.removeItem("loggedInBlogappUser"),x(null)}}),Object(j.jsxs)("div",{className:"content",children:[null===v?Object(j.jsx)(f,{login:B}):Object(j.jsx)("div",{className:"show__blogform",children:Object(j.jsx)(g,{class:"blog_form--toggle",buttonLabel:"Create New Blog",ref:_,children:Object(j.jsx)(m,{createBlog:S})})}),null!==v?Object(j.jsxs)("div",{className:"blog-container",children:[n.map((function(e){return Object(j.jsx)(p,{blog:e,updateLike:T,user:v.username,deleteBlog:C},e.id)}))," "]}):null]})]})};n(44);s.a.render(Object(j.jsx)(B,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.28da2884.chunk.js.map