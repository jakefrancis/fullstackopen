(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(19),u=n.n(a),i=n(10),o=n(2),s=n.n(o),l=n(4),b=n(3),j=n(0),p=function(e){var t=e.blog,n=e.updateLike,c=e.user,a=e.deleteBlog,u=Object(r.useState)(!0),i=Object(b.a)(u,2),o=i[0],s=i[1],l=Object(r.useState)(!1),p=Object(b.a)(l,2),d=p[0],f=p[1],h=function(){s(!o),o&&v()},v=function(){var e=t.likedBy.map((function(e){return e.username}));f(e.includes(c))};return Object(j.jsx)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},children:o?Object(j.jsxs)("p",{children:[t.title," - ",t.author," ",Object(j.jsx)("button",{onClick:h,children:"view"})]}):Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:[t.title," - ",t.author," ",Object(j.jsx)("button",{onClick:h,children:"hide"})]}),Object(j.jsx)("a",{href:"http"!==t.url.slice(0,4)?"//"+t.url:t.url,children:t.url}),Object(j.jsxs)("p",{children:["likes:",t.likes,Object(j.jsx)("button",{onClick:function(e){e.preventDefault(),n(t),f(!d)},children:d?"unlike":"like"})]}),Object(j.jsx)("h3",{children:t.user.name}),c===t.user.username?Object(j.jsx)("button",{onClick:function(e){e.preventDefault();var n="Are you sure you want to remove ".concat(t.title," by ").concat(t.author,"?");window.confirm(n)&&a(t)},children:"remove"}):null]})})},d=function(e){var t=e.login,n=Object(r.useState)(""),c=Object(b.a)(n,2),a=c[0],u=c[1],i=Object(r.useState)(""),o=Object(b.a)(i,2),p=o[0],d=o[1],f=function(){var e=Object(l.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({username:a,password:p}),u(""),d("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("form",{onSubmit:f,children:[Object(j.jsxs)("div",{children:["username",Object(j.jsx)("input",{type:"text",value:a,name:"Username",onChange:function(e){u(e.target.value)}})]}),Object(j.jsxs)("div",{children:["password",Object(j.jsx)("input",{type:"password",value:p,name:"Password",onChange:function(e){d(e.target.value)}})]}),Object(j.jsx)("button",{type:"submit",children:"login"})]})},f=function(e){var t=e.createBlog,n=Object(r.useState)(""),c=Object(b.a)(n,2),a=c[0],u=c[1],i=Object(r.useState)(""),o=Object(b.a)(i,2),s=o[0],l=o[1],p=Object(r.useState)(""),d=Object(b.a)(p,2),f=d[0],h=d[1];return Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({author:a,title:s,url:f}),l(""),h(""),u("")},children:[Object(j.jsx)("h2",{children:"Create New"}),Object(j.jsxs)("div",{children:["Title:",Object(j.jsx)("input",{type:"text",name:"Title",value:s,onChange:function(e){l(e.target.value)}})]}),Object(j.jsxs)("div",{children:["Author:",Object(j.jsx)("input",{type:"text",value:a,name:"Author",onChange:function(e){u(e.target.value)}})]}),Object(j.jsxs)("div",{children:["Url:",Object(j.jsx)("input",{type:"text",value:f,name:"Url",onChange:function(e){h(e.target.value)}})]}),Object(j.jsx)("button",{type:"submit",children:"save"})]})},h=function(e){var t=e.message;return null===t?null:Object(j.jsx)("div",{className:t.type,children:t.content})},v=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(b.a)(n,2),a=c[0],u=c[1],i={display:a?"none":""},o={display:a?"":"none"},s=function(){u(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{style:i,children:Object(j.jsx)("button",{onClick:s,children:e.buttonLabel})}),Object(j.jsxs)("div",{style:o,children:[e.children,Object(j.jsx)("button",{onClick:s,children:"cancel"})]})]})}));v.displayName="Togglable";var O=v,x=n(6),g=n.n(x),m="/api/blogs",k=null,w={getAll:function(){return g.a.get(m).then((function(e){return e.data}))},createBlog:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,g.a.post(m,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),likeBlog:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},r="".concat(m,"/").concat(t.id),e.next=4,g.a.put(r,t.likes,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},r="".concat(m,"/").concat(t.id),e.next=4,g.a.delete(r,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)}},y={login:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=function(){var e=Object(r.useState)([]),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),u=Object(b.a)(a,2),o=u[0],v=u[1],x=Object(r.useState)(null),g=Object(b.a)(x,2),m=g[0],k=g[1],S=Object(r.useRef)(),B=function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getAll();case 2:t=e.sent,c(t.sort((function(e,t){return t.likes-e.likes})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)(B,[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedInBlogappUser");if(e){var t=JSON.parse(e);k(t),w.setToken(t.token)}}),[]);var T=function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedInBlogappUser",JSON.stringify(n)),w.setToken(n.token),k(n),v({type:"notification",content:"".concat(n.username," login successfull")}),setTimeout((function(){v(null)}),5e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),v({type:"error",content:"wrong credentials"}),setTimeout((function(){v(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.createBlog(t);case 3:r=e.sent,S.current.toggleVisibility(),c(n.concat(r)),v({type:"notification",content:"a new blog ".concat(r.title).concat(""===r.author?"":" by ".concat(r.author))}),setTimeout((function(){v(null)}),5e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),v({type:"error",content:"Title and Url fields are required"}),setTimeout((function(){v(null)}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(l.a)(s.a.mark((function e(t){var r,a,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.likeBlog(t);case 3:r=e.sent,a=Object(i.a)(n),u=a.findIndex((function(e){return e.id===r.id})),a[u]=r,c(a.sort((function(e,t){return t.likes-e.likes}))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),v({type:"error",content:"like error"}),setTimeout((function(){v(null)}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(l.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.deleteBlog(t);case 3:r=(r=Object(i.a)(n)).filter((function(e){return e.id!==t.id})),c(r),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),v({type:"error",content:"unauthorized"}),setTimeout((function(){v(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{children:[Object(j.jsx)(h,{message:o}),Object(j.jsx)("h2",{children:"blogs"}),null===m?Object(j.jsx)(d,{login:T}):Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:[m.name," logged-in ",Object(j.jsx)("button",{onClick:function(e){e.preventDefault(),window.localStorage.removeItem("loggedInBlogappUser"),k(null)},children:"logout"})]}),Object(j.jsx)(O,{buttonLabel:"new blog",ref:S,children:Object(j.jsx)(f,{createBlog:C})})]}),null!==m?n.map((function(e){return Object(j.jsx)(p,{blog:e,updateLike:I,user:m.username,deleteBlog:A},e.id)})):null]})};n(44);u.a.render(Object(j.jsx)(S,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.5e0d5396.chunk.js.map